# Repeatedly zaps multiple enemies for a minor amount of damage. Pulls hit enemies closer together.

spark_jolt-cast:
  Skills:
  - skill:setRandomID
  - skill:Spell{id=[ - vskill{s=spark_jolt-exec;branch=true} @self ];name=Spark Jolt;type=ABILITY,ORDER;
    pierce=3;spellcd=0;charges=4;chargecd=0.5;charge_delay=1}

#pierce=0;projectiles=1;size=1;
spark_jolt-exec:
  Skills:
  - skill:spark_jolt-fire{origin=@forward{uel=true;f=1;yo=-0.2}} @forward{yo=-0.2;f=12;uel=true}
  - delay 4
  - skill:spark_jolt-cast @self

spark_jolt-fire:
  Skills:
  - skill:pierce-init{pierce=3}
  - setvarloc{var=originloc;v=@origin}
  - projectile{fo=true;ti=3;syo=0;sfo=0;hnp=true;se=false;ham=true;
    velocity=64;i=1;g=0;mr=25;hradius=0.2;vr=0.2;drawhitbox=false;
    onStart=[ - setvarloc{var=knockback_direction;val=@projectileforward{f=12}} ];
    onTick=spark_jolt-tick;
    onHit=spark_jolt-hit_entity;
    onEnd=spark_jolt-end}

spark_jolt-tick:
  Skills:
  - setvarloc{var=targetloc;v=@projectileforward{f=1;x="<random.float.-0.5to0.5>*<skill.var.size|1>";y="<random.float.-0.5to0.5>*<skill.var.size|1>";z="<random.float.-0.5to0.5>*<skill.var.size|1>"}}
  - e:pl{fo=true;origin=@VariableLocation{var=originloc};p=SPARK;a=1;db=0.3} @VariableLocation{var=targetloc}

  - e:pl{fo=true;origin=@VariableLocation{var=originloc};
    p=dust_color_transition;size=0.8;a=1;color1=#00fff2;color2=#ffd000;
    } @VariableLocation{var=targetloc}
    
  - setvarloc{var=originloc;v=@VariableLocation{var=targetloc}}  


spark_jolt-hit_entity:
  Skills:
  - skill{s=pierce-hit}
  - skill{s=spark_jolt-damage}
  - skill{s=[
    - setprojectiledirection{m=1} @LOT{yo=1}
    ]} @ENO{r=8;limit=1;sort=FURTHEST;conditions=[ - hasaura{name=spark_jolt<skill.var.randomid>} false ]}

spark_jolt-damage:
  Skills:
  - skill:damage-ability{damage_id=spark_jolt;
    damageMod=[ - variableMath{var=damage;equation="x*0.5"} ];
    onHit=[
    - vskill{s=knockback;v=1;vy=0.5;vertical=false}
    ]}
  

